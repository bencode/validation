!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.Validation=t():e.Validation=t()}(this,function(){return function(e){function t(n){if(r[n])return r[n].exports;var a=r[n]={exports:{},id:n,loaded:!1};return e[n].call(a.exports,a,a.exports,t),a.loaded=!0,a.exports}var r={};return t.m=e,t.c=r,t.p="",t(0)}([function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0}),t.Form=t.Validator=t["default"]=void 0;var a=r(1),i=n(a),o=r(3),s=n(o),u=r(6),l=n(u);t["default"]=i["default"],t.Validator=s["default"],t.Form=l["default"]},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){var r=m.Advice[t];if(!r)throw new Error("invalid advice: "+t);return{prompt:function(){var t=e.current||e.rules[0];r.prompt&&r.prompt(e,o(e,t.prompt))},success:function(t){r.success&&r.success(e,o(e,t.success))},error:function(t){if(r.error){var n=null!==e.errorMessage?e.errorMessage:t.error||t.message;r.error(e,o(e,n))}}}}function o(e,t){if(e.messages){var r=t;t=e.messages[r]||r}return t}function s(e,t,r){return e=e.get(),e.tagName.toLowerCase()===t&&(!r||e.type===r)}function u(e,t){var r=e.rules.filter(function(e){return e.instant});if(r.length){t.data("validationValue",t.val());var n=function(){var n=t.data("validationValue"),a=t.val();n!==a&&(e.validate({rules:r})?t.data("validationValue",a):e.current.invert&&a&&setTimeout(function(){t.val(n)},50))};t.on("input",n),t.on("keypress",n),t.on("keyup",n)}}Object.defineProperty(t,"__esModule",{value:!0});var l=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),f=r(2),c=n(f),d=r(3),v=n(d),h=r(5),p=n(h),m=function(){function e(t,r){if(a(this,e),!t||1!==t.nodeType)throw new Error("invalid element for validation, it should be a dom element.");r=r||{},this.elm=t,this.options=r.rules?r:{rules:r};var n=this.options.rules,o=void 0===n?[]:n;this.rules=Array.isArray(o)?o:[o],this.advice=i(this,r.advice||"default"),this.handler=e.Handler[r.handler||"default"],this.handler.call(this,this),this.messages=r.messages,this.enabled=!0}return l(e,null,[{key:"validate",value:function(t,r,n,a){var i=r.type||r.validate;if(!i)throw new Error("validate rule required.");if("required"===i)return!!t;if(!t&&!r.force)return!0;var o=i;if("string"==typeof i&&(o=e.Validator[i],!o))throw new Error("invalid validator: "+i);return"function"==typeof o?o.call(n,t,r,a):"function"!=typeof o.test||o.test(t)}}]),l(e,[{key:"enable",value:function(){this.enabled=!0}},{key:"disable",value:function(){this.enabled=!1,this.advice.prompt()}},{key:"validate",value:function(t){t=t||{};var r=(0,c["default"])(this.elm);if(!this.enabled||r.get().disabled||r.hasClass("disabled"))return!0;var n=r.val();n="string"==typeof n?n.trim():n;var a=t.rules||this.rules,i=!0,o=null;this.current=null,this.errorMessage=null;for(var s=0,u=a.length;s<u&&(o=a[s],i=e.validate(n,o,this,t),i=o.not?!i:i,i);s++);return this.current=o,t.noAdvice||this.advice[i?"success":"error"](o),i}}]),e}();m.Advice={},m.Handler={},m.Validator=v["default"],t["default"]=m,m.Handler["default"]=function(){var e=this,t=(0,c["default"])(this.elm),r="validationAdvicePrompt",n=null,a=function(){n||(n=setTimeout(function(){n=null},100),t.removeData(r),e.validate({from:"event"}))},i=this.advice;u(e,t),t.on("keydown",function(){t.data(r)||(i.prompt(),t.data(r,!0))}),t.on("change",a),s(t,"input","radio")||s(t,"input","checkbox")?t.on("click",a):(s(t,"input")||s(t,"textarea"))&&t.on("blur",a)},m.Advice["default"]=new p["default"],m.Advice.alert={error:function(e,t){alert(t)}}},function(e,t){(function(e){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n(e,t,r){var n=e.className.split(/\s+/g);t=t.split(/\s+/g),e.className=t.reduce(r,n).join(" ")}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),i=function(){function e(t){r(this,e),this.elm=t}return a(e,[{key:"get",value:function(){return this.elm}},{key:"on",value:function(e,t){this.elm.addEventListener(e,t,!1)}},{key:"hasClass",value:function(e){var t=new RegExp("(^|\\s)"+e+"(\\s|$)");return t.test(this.elm.className)}},{key:"addClass",value:function(e){n(this.elm,e,function(e,t){return e.indexOf(t)===-1&&e.push(t),e})}},{key:"removeClass",value:function(e){n(this.elm,e,function(e,t){var r=e.indexOf(t);return r!==-1&&e.splice(r,1),e})}},{key:"val",value:function(e){var t=this.elm;return void 0===e?t.value:void(t.value=e)}},{key:"data",value:function(e,t){var r=this.elm;void 0!==t&&(r.dataset[e]=JSON.stringify(t));var n=r.dataset[e];if(n)try{return JSON.parse(n)}catch(a){console.error("invalid json: "+n)}}},{key:"removeData",value:function(e){delete this.elm.dataset[e]}}]),e}(),o=e.jQuery||e.Zepto||function(e){return new i(e)};t["default"]=o}).call(t,function(){return this}())},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}function a(e){for(var t=0,r=0,n=e.length;r<n;r++)i(e[r])||t++;return t}function i(e){return!e||"string"==typeof e&&/^\s*$/.test(e)}function o(e,t,r){if(!r.test(e))return!1;t=t||[];var n=void 0!==t.min?t.min:Number.MIN_VALUE,a=void 0!==t.max?t.max:Number.MAX_VALUE;return e=parseFloat(e),n<=e&&e<=a}function s(e,t,r,n){function a(a){if(!s){s=!0;var i=(0,l["default"])(e.elm);i.data("validationResult",a),i.data("validationLastValue",t),n.noAdvice||(e.errorMessage=a.errorMessage,e.advice[a.valid?"success":"error"](r))}}var i=r.validate;if(!i)throw new Error("rule.validate required");var o=i.call(e,t,r);if(!o||"function"!=typeof o.then)throw new Error("async validate should return a promise object");var s=!1;setTimeout(function(){a({valid:!1,errorMessage:c["default"].Timeout})},5e3),o.then(function(e){e=e||{},a({valid:e.valid,errorMessage:e.errorMessage})},function(){a({valid:!1,errorMessage:c["default"].NetworkError})})}Object.defineProperty(t,"__esModule",{value:!0});var u=r(2),l=n(u),f=r(4),c=n(f);t.regexp=function(e,t){return new RegExp(t.pattern).test(e)},t.length=function(e,t){if(t.length)return e.length===t.length;var r=void 0!==t.minLength?t.minLength:Number.MIN_VALUE,n=void 0!==t.maxLength?t.maxLength:Number.MAX_VALUE;return r<=e.length&&e.length<=n},t.range=function(e,t){return o(e,t,/^\d+(\.\d+)?$/)},t.intRange=function(e,t){return o(e,t,/^\d+$/)};var d=/^\w+([-+.]\w+)*@\w+([-.]\w+)*\.\w+([-.]\w+)*$/;t.email=function(e){return d.test(e)},t.array=function(e,t){if(!Array.isArray(e))return!1;var r=t.ignoreEmpty?a(e):e.length;if(t.length)return r===t.length;var n=void 0!==t.minLength?t.minLength:Number.MIN_VALUE,i=void 0!==t.maxLength?t.maxLength:Number.MAX_VALUE;return n<=r&&r<=i},t.async=function(e,t,r){var n=(0,l["default"])(this.elm),a=n.data("validationLastValue");if(a===e){var i=n.data("validationResult")||{};return this.errorMessage=i.errorMessage,i.valid}return s(this,e,t,r),this.errorMessage="",void 0===a||"event"===r.from},t["default"]=t},function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t["default"]={Timeout:"timeout",NetworkError:"network error"}},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e){for(var t=e.nextSibling;t;){if(1===t.nodeType&&(0,l["default"])(t).hasClass("validation-assist"))return t;t=t.nextSibling}return null}function o(e){var t=document.createElement("div");(0,l["default"])(t).addClass("validation-assist");var r=e.nextSibling;return r?e.parentNode.insertBefore(t,r):e.parentNode.appendChild(t),t}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),u=r(2),l=n(u),f=function(){function e(t){a(this,e),this.options=Object.assign({fieldClassNames:{prompt:"validation-prompt",success:"validation-success",error:"validation-error"},assistClassNames:{prompt:"validation-assist-prompt",success:"validation-assist-success",error:"validation-assist-error"},getAssist:i},t)}return s(e,[{key:"prompt",value:function(e,t){this.show(e.elm,t,"prompt")}},{key:"success",value:function(e,t){this.show(e.elm,t,"success")}},{key:"error",value:function(e,t){this.show(e.elm,t,"error")}},{key:"show",value:function(e,t,r){r=r||"error";var n=this.options,a=n.getAssist(e)||o(e),i=(0,l["default"])(a),s=(0,l["default"])(e),u=n.fieldClassNames,f=n.assistClassNames;s.removeClass(u.prompt+" "+u.success+" "+u.error),i.removeClass(f.prompt+" "+f.success+" "+f.error),s.addClass(u[r]),i.addClass(f[r]),t?(a.innerHTML=t,a.style="display: ;"):(a.innerHTML="",a.style="display: none;")}}]),e}();t["default"]=f},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e){(0,l["default"])(e.form).on("submit",function(t){e.validate()||t.preventDefault()})}function o(e){try{e.focus&&e.focus()}catch(t){console.error(t)}}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),u=r(2),l=n(u),f=r(1),c=n(f),d=function(){function e(t,r){a(this,e),this.form=t,this.options=r||{},this.refresh(),this.options.validateOnSubmit!==!1&&"form"===t.tagName.toLowerCase()&&i(this)}return s(e,[{key:"validate",value:function(e){e=e||{};for(var t=e.fields?e.fields.reduce(function(e,t){var r=t.data("validation");return r&&e.push(r),e},[]):this.validations,r=!0,n=!1,a=0,i=t.length;a<i;a++){var s=t[a];s.validate(e)||(r=!1,n||(o(s.elm),n=!0))}return r}},{key:"refresh",value:function(){var e=this.form,t=this.options,r=e.querySelectorAll("input,select,textarea");this.validations=Array.from(r).reduce(function(e,r){r=(0,l["default"])(r);var n=r.data("validation");if(!n){var a=r.data("validate");if(a){var i=Object.assign({},t,a);n=new c["default"](r.get(),i),r.data("validation",n)}}return n&&e.push(n),e},[])}}]),e}();t["default"]=d}])});